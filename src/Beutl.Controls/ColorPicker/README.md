Ported from https://github.com/amwx/FluentAvalonia/tree/9e35813b3e3e649ad254ff6be4a35e52ac96d051

